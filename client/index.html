<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sourcebook Generator</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <h1>📚 Sourcebook Generator</h1>
      <p class="subtitle">Learning Outcome을 입력하면 Sourcebook 카드를 자동생성합니다</p>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Input Section -->
      <section class="input-section">
        <h2>1단계: Learning Outcome 입력</h2>
        <div class="input-guide">
          <div class="guide-header" id="guideToggle">
            <span class="guide-icon">?</span>
            <span>좋은 Learning Outcome 작성법</span>
            <span class="guide-arrow" id="guideArrow">&#9662;</span>
          </div>
          <div class="guide-body" id="guideBody">
            <p class="guide-desc">초안을 넣고 "Outcome 다듬기"를 누르면 AI가 아래 5대 원칙에 맞게 자동으로 보강합니다:</p>
            <div class="guide-items">
              <div class="guide-item">
                <div class="guide-item-label">1. Observable (관찰 가능)</div>
                <div class="guide-item-desc">"이해한다/안다" 대신, 관찰할 수 있는 행동 동사로 표현하세요.</div>
                <div class="guide-item-example">&#10007; "입출력 장치를 이해한다" &#8594; &#10003; "터치스크린과 물리 버튼의 피드백 차이를 비교 설명할 수 있다"</div>
              </div>
              <div class="guide-item">
                <div class="guide-item-label">2. Single Focus (단일 초점)</div>
                <div class="guide-item-desc">하나의 문장에 하나의 핵심 행동만. "A하고 B하고 C한다"는 피하세요.</div>
                <div class="guide-item-example">&#10007; "UI를 설계하고, 테스트하고, 결과를 분석한다" &#8594; &#10003; "테스트 결과를 바탕으로 UI 개선점을 도출할 수 있다"</div>
              </div>
              <div class="guide-item">
                <div class="guide-item-label">3. Context (맥락/조건)</div>
                <div class="guide-item-desc">"어떤 상황에서" 수행하는지 조건을 명시하세요.</div>
                <div class="guide-item-example">&#10007; "데이터를 분석할 수 있다" &#8594; &#10003; "사용자 행동 로그에서 이탈 패턴을 분석할 수 있다"</div>
              </div>
              <div class="guide-item">
                <div class="guide-item-label">4. Scope (범위 한정)</div>
                <div class="guide-item-desc">핵심 키워드와 하위 주제를 명시하여 범위를 좁히세요.</div>
                <div class="guide-item-example">&#10007; "인터랙션 디자인을 할 수 있다" &#8594; &#10003; "모바일 환경에서 제스처 vs 음성 인터랙션의 장단점을 비교할 수 있다"</div>
              </div>
              <div class="guide-item">
                <div class="guide-item-label">5. Cognitive Level (인지 수준)</div>
                <div class="guide-item-desc">수업 수준에 맞는 동사를 선택하세요: 기초(나열/설명) → 중급(비교/적용) → 고급(분석/설계)</div>
              </div>
            </div>
          </div>
        </div>
        <textarea
          id="outcomeInput"
          class="textarea"
          placeholder="Learning Outcome 초안을 여기에 붙여넣으세요.&#10;&#10;예: 컴퓨터-인간 상호작용에 대한 기본 이해력. 컴퓨터와 인간의 상호작용 과정을 이해하고, 디지털 제품이 작동하는 기본적인 원리와 지식을 안다.&#10;&#10;초안을 넣고 'Outcome 다듬기'를 누르면 AI가 5대 원칙(Observable, Single Focus, Context, Scope, Cognitive Level)에 맞게 자동 보강합니다."
          rows="10"
        ></textarea>
        <div class="button-row">
          <button id="refineBtn" class="btn btn-refine">Outcome 다듬기</button>
          <button id="generateBtn" class="btn btn-primary">카드 생성 (10개)</button>
        </div>
        <div id="refineMessage" class="refine-message" style="display: none;">
          <span class="spinner"></span> AI가 Outcome을 분석하고 있습니다...
        </div>
        <div id="refineResult" class="refine-result" style="display: none;">
          <div class="refine-result-header">
            <span class="refine-result-label">AI 추천 개선안</span>
            <span id="refineChanges" class="refine-changes"></span>
          </div>
          <div id="refinePreview" class="refine-preview"></div>
          <div class="refine-actions">
            <button id="applyRefineBtn" class="btn btn-apply">적용하기</button>
            <button id="dismissRefineBtn" class="btn btn-dismiss">무시</button>
          </div>
        </div>
        <div id="loadingMessage" class="loading-message" style="display: none;">
          <span class="spinner"></span> 카드를 생성 중입니다... (약 30초 소요)
        </div>
      </section>

      <!-- Error Message -->
      <div id="errorMessage" class="error-message" style="display: none;"></div>

      <!-- Cards Section -->
      <section id="cardsSection" class="cards-section" style="display: none;">
        <h2>2단계: 카드 선택</h2>
        <p class="selection-info">수업에 적합한 카드들을 선택하세요 (최소 1개, 최대 10개)</p>

        <div class="cards-container" id="cardsContainer"></div>

        <!-- Export Section -->
        <div class="export-section">
          <p id="selectedCount" class="selected-count"></p>
          <div class="button-group">
            <button id="exportPdfBtn" class="btn btn-success">PDF로 내보내기</button>
            <button id="exportJsonBtn" class="btn btn-info">JSON으로 다운로드</button>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p>Sourcebook Guideline을 기반으로 하는 학습자 주도 토론 수업 자료 생성 도구</p>
    </footer>
  </div>

  <!-- Hidden PDF Template -->
  <div id="pdfTemplate" style="display: none;"></div>

  <script src="app.js"></script>
</body>
</html>
